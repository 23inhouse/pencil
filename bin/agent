#!/usr/bin/env ruby

require_relative '../lib/pencil'

puts Pencil::Version.to_s
c = Pencil::Docker.new

while true do

  c.observe.each do |id, data|
    consul = Pencil::Consul.new(host: 'localhost', port: 8500)
    consul.register_service(service_name: data['image'], host_port: data['host_port'])
  end

  sleep 10
end
